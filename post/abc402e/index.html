<html>
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Blame&#39;s Blog - ABC402 E - Payment Required </title>
    
    
    <meta content="Atcoder, Solution" name="keywords">
    
    <meta content="Blame&#39;s Blog - 題目大意 有 $N$ 個題目
第 $i$ 個題目有 $S_i$ 的分數，且每次 submission 都必須花費 $C_i$ 元
今天 Takahashi 有總共 $X$ 元，他對於第 $i$ 題有著 $P_i$ 的機率可以解出來
那請問今天 Takahashi 在花費總共不超過 $X$ 元且他選擇最佳策略的情況下，他總共獲得的分數的期望值為多少?
註1. 他可以看到上次 submission 的結果再決定下次 submit 的題目
註2. 同一題連續解出兩次以上的分數等同於第一次解出來的分數
$1 \le N \le 8$
$1 \le S_i \le 2718$
$1 \le C_i \le X \le 5000$
$1 \le P_i \le 100$
解法 首先，我們可以注意到 $N \le 8$ 這個重要的條件
也就是說我們可以往位元枚舉、全排列這方面想
那麼我們先仔細觀察 (註2.)
我們發現只要單題解出一次後，再多的 submission 都是浪費
所以我們可以嘗試用二進制來表示目前解出來的題目的狀態" name="description">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    

    

    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            extensions: ["tex2jax.js"],
            jax: ["input/TeX", "output/HTML-CSS"],
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: true
            },
            "HTML-CSS": { availableFonts: ["TeX"] }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>
    

    <link rel="stylesheet" href="/layui/css/layui.css">
    <link rel="stylesheet" href="/self/css/default.css">
    <script src=" /layui/layui.js"></script>

    <link rel="stylesheet" async href="/self/css/markdown.min.css">
    <link rel="stylesheet" async href="/self/css/gallery.css">
    
    
    

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
    <script async src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js" integrity="sha256-PZEg+mIdptYTwWmLcBTsa99GIDZujyt7VHBZ9Lb2Jys=" crossorigin="anonymous"></script></head>

<body>
    
    <header class="layui-header layui-bg-cyan">

    
    
    <a class="nav-self-logo" href="/">
        Blame&#39;s Blog
    </a>

    <ul class="layui-nav layui-layout-right layui-bg-cyan" lay-filter="">
        
        
        <li class="layui-nav-item" id="nav_big"><a href="/post/">Posts</a></li>
        

        

        
        <li class="layui-nav-item" id="nav_small">
            <a href="javascript:;">
                <i class="layui-icon layui-icon-app" style="font-size: 24px;"></i>
            </a>

            <dl class="layui-nav-child">
                
                <dd><a href="/post/">Posts</a></dd>
                

                
            </dl>
        </li>
    </ul>
</header>

<script>
layui.use('element', function(){
  var element = layui.element;
});
</script>

        <div id="content" style="min-height:80%">
<div class="layui-container" style="margin-bottom: 10px">
    

    <div class="layui-row layui-col-space10">
        <div class="layui-col-md8 layui-col-sm12 layui-col-xs12">
            <div class="layui-card single-card">
                <br />
                <blockquote class="self-elem-quote  markdown-body single-title" >
                    <h1>ABC402 E - Payment Required</h1>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-10</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/atcoder/">
            <span class="layui-badge " style="vertical-align: 2px;">Atcoder</span>
        </a>
    
        <a href="/tags/solution/">
            <span class="layui-badge " style="vertical-align: 2px;">Solution</span>
        </a>
    
    
</h3>

                </blockquote>
                <div class="layui-card-body markdown-body single-content">
                    <h2 id="題目大意">題目大意</h2>
<p>有 $N$ 個題目</p>
<p>第 $i$ 個題目有 $S_i$ 的分數，且每次 submission 都必須花費 $C_i$ 元</p>
<p>今天 Takahashi 有總共 $X$ 元，他對於第 $i$ 題有著 $P_i$ 的機率可以解出來</p>
<p>那請問今天 Takahashi 在花費總共不超過 $X$ 元且他選擇最佳策略的情況下，他總共獲得的分數的期望值為多少?</p>
<ul>
<li>
<p>註1. 他可以看到上次 submission 的結果再決定下次 submit 的題目</p>
</li>
<li>
<p>註2. 同一題連續解出兩次以上的分數等同於第一次解出來的分數</p>
</li>
<li>
<p>$1 \le N \le 8$</p>
</li>
<li>
<p>$1 \le S_i \le 2718$</p>
</li>
<li>
<p>$1 \le C_i \le X \le 5000$</p>
</li>
<li>
<p>$1 \le P_i \le 100$</p>
</li>
</ul>
<h2 id="解法">解法</h2>
<p>首先，我們可以注意到 $N \le 8$ 這個重要的條件</p>
<p>也就是說我們可以往位元枚舉、全排列這方面想</p>
<p>那麼我們先仔細觀察 (註2.)</p>
<p>我們發現只要單題解出一次後，再多的 submission 都是浪費</p>
<p>所以我們可以嘗試用二進制來表示目前解出來的題目的狀態</p>
<p>那麼已經拿到狀態後，我們則可以採取使用動態規劃的方式去解決期望值問題</p>
<p>TODO 我不會推期望值的DP式</p>
<h2 id="code">CODE</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;bits/stdc++.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">signed</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	ios<span style="color:#f92672">::</span>sync_with_stdio(false), cin.tie(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> n, x; cin <span style="color:#f92672">&gt;&gt;</span> n <span style="color:#f92672">&gt;&gt;</span> x;
</span></span><span style="display:flex;"><span>	vector<span style="color:#f92672">&lt;</span>array<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span>, <span style="color:#ae81ff">3</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;</span> v(n);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">auto</span> <span style="color:#f92672">&amp;</span>[a, b, c] <span style="color:#f92672">:</span> v) cin <span style="color:#f92672">&gt;&gt;</span> a <span style="color:#f92672">&gt;&gt;</span> b <span style="color:#f92672">&gt;&gt;</span> c;
</span></span><span style="display:flex;"><span>	vector<span style="color:#f92672">&lt;</span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">long</span> <span style="color:#66d9ef">double</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;</span> dp(<span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>n, vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">long</span> <span style="color:#66d9ef">double</span><span style="color:#f92672">&gt;</span> (x<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">long</span> <span style="color:#66d9ef">double</span> ANS <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; k <span style="color:#f92672">&lt;=</span> x; k<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>n; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">long</span> <span style="color:#66d9ef">double</span> ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> n; j<span style="color:#f92672">++</span>) <span style="color:#66d9ef">if</span>(i<span style="color:#f92672">&gt;&gt;</span>j<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span><span style="color:#f92672">^</span><span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">auto</span> [a, b, c] <span style="color:#f92672">=</span> v[j];
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">if</span>(k <span style="color:#f92672">&lt;</span> b) <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">long</span> <span style="color:#66d9ef">double</span> p <span style="color:#f92672">=</span> (<span style="color:#66d9ef">long</span> <span style="color:#66d9ef">double</span>)c<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>				ans <span style="color:#f92672">=</span> max(ans, (dp[i<span style="color:#f92672">|</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>j)][k<span style="color:#f92672">-</span>b] <span style="color:#f92672">+</span> a) <span style="color:#f92672">*</span> p <span style="color:#f92672">+</span> dp[i][k<span style="color:#f92672">-</span>b] <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>p));
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			dp[i][k] <span style="color:#f92672">=</span> ans;
</span></span><span style="display:flex;"><span>			ANS <span style="color:#f92672">=</span> max(ANS, ans);
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	cout <span style="color:#f92672">&lt;&lt;</span> fixed <span style="color:#f92672">&lt;&lt;</span> setprecision(<span style="color:#ae81ff">6</span>) <span style="color:#f92672">&lt;&lt;</span> ANS <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#39;\n&#39;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></div>
            </div>
        </div>

        <div class="layui-col-md4 layui-col-sm12 layui-col-xs12">
            

            <div class="layui-card single-card">
                <h2 class="single-title">Recent Posts</h2>
            
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote " style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/intro/">
                        <h3 class="">自我介紹</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-18</span>

    
    

    

    

    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote " style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/abc345f/">
                        <h3 class="">ABC345 F - Many Lamps</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-17</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/atcoder/">
            <span class="layui-badge " style="vertical-align: 2px;">Atcoder</span>
        </a>
    
        <a href="/tags/solution/">
            <span class="layui-badge " style="vertical-align: 2px;">Solution</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote " style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/toj1008/">
                        <h3 class="">TOJ 1008 速通麥塊 題解</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-15</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/toj/">
            <span class="layui-badge " style="vertical-align: 2px;">TOJ</span>
        </a>
    
        <a href="/tags/matrix/">
            <span class="layui-badge " style="vertical-align: 2px;">Matrix</span>
        </a>
    
        <a href="/tags/math/">
            <span class="layui-badge " style="vertical-align: 2px;">Math</span>
        </a>
    
        <a href="/tags/dynamic-programming/">
            <span class="layui-badge " style="vertical-align: 2px;">Dynamic Programming</span>
        </a>
    
        <a href="/tags/solution/">
            <span class="layui-badge " style="vertical-align: 2px;">Solution</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote " style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/nccu/">
                        <h3 class="">2025全國賽心得</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-14</span>

    
    

    

    

    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote " style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/ntnu/">
                        <h3 class="">115學年台灣師範大學資工系特選心得</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-12</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/%e7%89%b9%e9%81%b8/">
            <span class="layui-badge " style="vertical-align: 2px;">特選</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
            
            <br />
            </div>
        </div>

    </div>
</div>


        </div><footer>
    
    
    <div class="layui-container">
        <p class="copyright">&copy; All rights reserved. Powered by <a href='https://gohugo.io' style='color:#FFFFFF'>Hugo</a> and <a href='https://github.com/ertuil/erblog' style='color:#FFFFFF'>Erblog</a>.</p>
    </div>
</footer>

</body>
</html>
