<html>
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Blame&#39;s Blog - ABC433 F - 1122 Subsequence 2 </title>
    
    
    <meta content="Atcoder, Solution, Math, Binomial Coefficients, Generating Functions" name="keywords">
    
    <meta content="Blame&#39;s Blog - 防暴雷" name="description">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    
        <link rel="icon" href="/img/logo.jpg">
    

    

    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            extensions: ["tex2jax.js"],
            jax: ["input/TeX", "output/HTML-CSS"],
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: true
            },
            "HTML-CSS": { availableFonts: ["TeX"] }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>
    

    <link rel="stylesheet" href="/layui/css/layui.css">
    <link rel="stylesheet" href="/self/css/default.css">
    <script src=" /layui/layui.js"></script>

    <link rel="stylesheet" async href="/self/css/markdown.min.css">
    <link rel="stylesheet" async href="/self/css/gallery.css">
    
    
    

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
    <script async src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js" integrity="sha256-PZEg+mIdptYTwWmLcBTsa99GIDZujyt7VHBZ9Lb2Jys=" crossorigin="anonymous"></script></head>

<script>
  MathJax = {
    tex: {
      inlineMath: {'[+]': [['$', '$']]}
    }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-svg.js"></script>
<body>
    
    <header class="layui-header layui-bg-cyan">

    
        <a href=""><img src="/img/logo.jpg" class="layui-nav-img" style="margin-left:10px;margin-top:-10px"></a>
    
    
    <a class="nav-self-logo" href="/">
        Blame&#39;s Blog
    </a>

    <ul class="layui-nav layui-layout-right layui-bg-cyan" lay-filter="">
        
        
        <li class="layui-nav-item" id="nav_big"><a href="/post/">Posts</a></li>
        

        

        
        <li class="layui-nav-item" id="nav_small">
            <a href="javascript:;">
                <i class="layui-icon layui-icon-app" style="font-size: 24px;"></i>
            </a>

            <dl class="layui-nav-child">
                
                <dd><a href="/post/">Posts</a></dd>
                

                
            </dl>
        </li>
    </ul>
</header>

<script>
layui.use('element', function(){
  var element = layui.element;
});
</script>

        <div id="content" style="min-height:80%">
<div class="layui-container" style="margin-bottom: 10px">
    

    <div class="layui-row layui-col-space10">
        <div class="layui-col-md8 layui-col-sm12 layui-col-xs12">
            <div class="layui-card single-card">
                <br />
                <blockquote class="self-elem-quote self-elem-quote-bg-red markdown-body single-title" >
                    <h1>ABC433 F - 1122 Subsequence 2</h1>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2026-01-02</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/atcoder/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Atcoder</span>
        </a>
    
        <a href="/tags/solution/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Solution</span>
        </a>
    
        <a href="/tags/math/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Math</span>
        </a>
    
        <a href="/tags/binomial-coefficients/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Binomial Coefficients</span>
        </a>
    
        <a href="/tags/generating-functions/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Generating Functions</span>
        </a>
    
    
</h3>

                </blockquote>
                <div class="layui-card-body markdown-body single-content">
                    <h2 id="題目">題目</h2>
<p>定義 字串 $T$ 為一個 11-22 字串需符合以下條件</p>
<ul>
<li>$T$ 是一個非空字串，且滿足每個字元皆為數字</li>
<li>$\lvert T \rvert$ 是偶數，$\vert T \vert$ 代表字串 $T$ 的長度，更具體的說 $T$ 的長度為偶數</li>
<li>$T$ 的 $1 \sim \frac{\lvert T \rvert}{2}$ 字元皆相同</li>
<li>$T$ 的 $(\frac{\lvert T \rvert}{2} + 1) \sim \vert T \vert$ 字元皆相同</li>
<li>將第 $1$ 個字元 $+1$ 可以得到最後一位字元，也就是說 $T_1 + 1 = T_{\vert T \vert}$</li>
</ul>
<p>今天給你一個由數字組成的字串 $S$，請找出 $S$ 有多少種子序列(不一定連續)符合 11-22 字串</p>
<p>阿答案很大，要模 $998244353$</p>
<h2 id="題解">題解</h2>
<p>我們可以先分解一下題目，這種題目通常都需要先觀察 + 拆解，歸納為數學模型才能更好的解</p>
<h3 id="觀察-1">觀察 1</h3>
<p>不難發現的發現子序列長度必須為偶數</p>
<h3 id="猜想">猜想</h3>
<p>我們可以猜猜看這題的做法</p>
<p>猜猜看是不是排組</p>
<h3 id="分析出式子">分析出式子</h3>
<p>發現我們可以每次枚舉斷點，也就是子序列中的 $\frac{len}{2}$ 的字元</p>
<p>怎麼說呢?</p>
<p>我們可以計算字元 $i$ 可以組成的合法子序列的可能性</p>
<p>假設目前合法子序列的長度的一半為 $k$</p>
<p>那麼可能性就為</p>
<p>$$
{\binom{count(S_{1 \ldots i}, S_i)}{k-1}} \times {\binom{count(S_{i+1 \ldots \vert S \vert}, S_{i+1})}{k}}
$$</p>
<p>看不懂的話，可以理解為</p>
<p>我們每次選一個東西卡在中間，讓他成為我們這個序列的前半的最後一個字元</p>
<p>那麼前面一半剩下的選擇就是從 $1 \sim i-1$ 選 $k-1$ 個跟他一樣的字元填上去</p>
<p>後面一半就是從 $i+1 \sim \vert S \vert$ 選 $k$ 個比他大一的字元填上去</p>
<h3 id="整理出來了">整理出來了?</h3>
<p>那麼題目就從原題轉換為求數學式了?</p>
<p>$$
\begin{aligned}
\text{ans} &amp;= \sum_{i=1}^{\vert S \vert} \sum_{k=1}^{\min(A+1, B)} \binom{A}{k-1} \times \binom{B}{k}
\end{aligned}
$$</p>
<p>其中</p>
<ul>
<li>$A = count(S_{1 \ldots i-1}, S_i)$</li>
<li>$B = count(S_{i+1, \ldots \vert S \vert}, S_i+1)$</li>
</ul>
<p>我們發現這個式子還有地方怪怪的欸?</p>
<p>我們要怎麼計算 $count()$ ?</p>
<h3 id="count">count</h3>
<p>觀察到這題的計算都為離線</p>
<p>所以我們可以先對字串做壞壞的事情後再計算</p>
<p>壞壞的事情? 當然是對他做前綴和阿!!!</p>
<p>定義一二維前綴和陣列 $pre[c][i]$，代表 $1 \sim i$ 字元中有多少個 $c$</p>
<p>所以可以得出</p>
<p>$$
pre_{c, i} = \begin{cases}
0 &amp; \text{if } i = 0 \\
pre_{c, i-1} + [S_i = c] &amp; \text{if } i &gt; 0
\end{cases}
$$</p>
<h3 id="整理一下">整理一下</h3>
<p>$$
\begin{aligned}
\text{ans} &amp;= \sum_{i=1}^{\vert S \vert} \sum_{k=1}^{\min(A+1, B)} \binom{A}{k-1} \times \binom{B}{k}
\end{aligned}
$$</p>
<ul>
<li>$A = pre_{S_i, i}$</li>
<li>$B = pre_{S_i+1, \vert S \vert} - pre_{S_i+1, i}$</li>
</ul>
<h3 id="蛤-不能暴力做嗎">蛤? 不能暴力做嗎?</h3>
<p>我們分一下複雜度，假如我們對每個位置 $i$，求每個 $k$ 的東西</p>
<p>那麼時間複雜度為 $O(N K) = O(N^2)$ 欸</p>
<p>超級爛QQ</p>
<h3 id="二項式定理">二項式定理</h3>
<p>先引入一個定理</p>
<p>定義函式 $f$ 符合</p>
<p>$$
f(x) = (1 + x)^A
$$</p>
<p>那麼</p>
<p>$$
\sum^{A}_{i = 0} \binom{A}{i} = f(1)
$$</p>
<p>也就是我們熟知的<strong>二項式定理</strong></p>
<h3 id="小定義">小定義</h3>
<p>我們先定義 $C(n, m)$ 假如 $m &gt; n$ 的話為 $0$</p>
<p>這樣比較好算</p>
<p>然後 $\sum$ 不放上界就是定義為無限大</p>
<h3 id="魔法">魔法</h3>
<p>我們必須要通靈出一個函式 $p$</p>
<p>$$
p(x)
= \sum_{i = 1} \binom{A}{i-1} x^{i-1}
= \sum_{i = 0} \binom{A}{i} x^{i}
= (1 + x)^A
$$</p>
<p>也需要通靈出相對應的函式 $q$</p>
<p>$$
q(x)
= \sum_{j = 0} \binom{B}{j} x^{\frac{1}{j-1}}
= x \cdot (1 + \frac{1}{x})^B
= \frac{1}{x^{B-1}} \cdot (1 + x)^B
$$</p>
<blockquote>
<p>假如不知道為什麼會這樣變變變的，可以把式子展開看看</p>
</blockquote>
<p>觀察一下，發現 $p \times q$ 會超級剛好的變成</p>
<p>$$
p(x) \times q(x) = \sum_{i = 0} \sum_{j=0} \binom{A}{i} x^i \times \binom{B}{j} x^{\frac{1}{j-1}} =  (1 + x)^A \cdot (\frac{1}{x^{B-1}} \cdot (1 + x)^B)
$$</p>
<p>也就是說 $p \times q$ 出來還會是一個超級好看的多項式</p>
<p>$$
p(x) \times q(x) = \frac{1}{x^{B-1}} \cdot (1 + x)^{A+B}
$$</p>
<h3 id="將魔法整理">將魔法整理</h3>
<p>我們發現，當 $i = j-1$ 的時候</p>
<p>根據多項式乘法，我們會發現 $p(1) \times q(1)$ 的 $x^0$ 項次剛好為我們的答案</p>
<blockquote>
<p>一樣把式子展開可以得出</p>
</blockquote>
<p>那麼我們既然知道 $(1 + x)^{A+B}$ 代入 $x = 1$ 進去為</p>
<p>$$
(1 + 1)^{A+B} = \sum_{i=0} \binom{A+B}{i}
$$</p>
<p>那麼我們求 $x^0$ 項次不是就等同於求 $\binom{A+B}{0}$ 嗎?</p>
<p>對嗎?</p>
<p>不對!</p>
<p>我們發現 $p(x) \times q(x)$ 前面還有一個 $\frac{1}{x^{B-1}}$</p>
<p>所以整體的 $x^0$ 項應為 $(1 + x)^{A+B}$ 的第 $x^{B-1}$ 項!</p>
<h3 id="最終">最終</h3>
<p>最終我們得出來了一個超級強的式子</p>
<p>$$
\sum_{k = 1} \binom{A}{k-1} \times \binom{B}{k} = \binom{A+B}{B-1} = \binom{A+B}{A+1}
$$</p>
<blockquote>
<p>後面那個變換是因為 $B-1$ 也許會變負數，所以用組合的對稱性變換一下了</p>
</blockquote>
<h3 id="結語">結語</h3>
<p>實作沒有很複雜，所以不放 code 了</p>
<p>但是剛剛的那些數學推導過程很重要</p>
<p>因為那就是大家熟知的 <strong>生成函數</strong></p>
<p>整體的概念就是把東西丟上去多項式去計算</p>
<p>然後順便提一句，這題在 ABC 那場打完是青題難度</p>
<p>所以大家特別會數學，不能輸了!!!</p>
</div>
            </div>
        </div>

        <div class="layui-col-md4 layui-col-sm12 layui-col-xs12">
            
            <div class="layui-card single-card">
                <h2 class="single-title">Relevant Topics</h2>
                
                	
                    <div style="margin-left: 10px;">
                        <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                            <a href="/post/atcoder/abc345f/">
                                <h3 class="">ABC345 F - Many Lamps</h3>
                            </a>
                            
                            <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-17</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/atcoder/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Atcoder</span>
        </a>
    
        <a href="/tags/solution/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Solution</span>
        </a>
    
    
</h3>

                        </blockquote>
                    </div>
                	
                    <div style="margin-left: 10px;">
                        <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                            <a href="/post/toj/toj1008/">
                                <h3 class="">TOJ 1008 速通麥塊</h3>
                            </a>
                            
                            <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-15</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/toj/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">TOJ</span>
        </a>
    
        <a href="/tags/matrix/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Matrix</span>
        </a>
    
        <a href="/tags/math/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Math</span>
        </a>
    
        <a href="/tags/dynamic-programming/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Dynamic Programming</span>
        </a>
    
        <a href="/tags/solution/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Solution</span>
        </a>
    
    
</h3>

                        </blockquote>
                    </div>
                	
                
                <br />
            </div>
            

            <div class="layui-card single-card">
                <h2 class="single-title">Recent Posts</h2>
            
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/atcoder/abc433f/">
                        <h3 class="">ABC433 F - 1122 Subsequence 2</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2026-01-02</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/atcoder/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Atcoder</span>
        </a>
    
        <a href="/tags/solution/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Solution</span>
        </a>
    
        <a href="/tags/math/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Math</span>
        </a>
    
        <a href="/tags/binomial-coefficients/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Binomial Coefficients</span>
        </a>
    
        <a href="/tags/generating-functions/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Generating Functions</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/atcoder/abc345f/">
                        <h3 class="">ABC345 F - Many Lamps</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-17</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/atcoder/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Atcoder</span>
        </a>
    
        <a href="/tags/solution/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Solution</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/toj/toj1008/">
                        <h3 class="">TOJ 1008 速通麥塊</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-15</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/toj/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">TOJ</span>
        </a>
    
        <a href="/tags/matrix/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Matrix</span>
        </a>
    
        <a href="/tags/math/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Math</span>
        </a>
    
        <a href="/tags/dynamic-programming/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Dynamic Programming</span>
        </a>
    
        <a href="/tags/solution/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Solution</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/contest/nccu/nccu/">
                        <h3 class="">2025全國賽心得</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-14</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/experience/">
            <span class="layui-badge layui-bg-green" style="vertical-align: 2px;">Experience</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote self-elem-quote-bg-red" style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/hello/intro/">
                        <h3 class="">自我介紹</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-08</span>

    
    

    

    

    
    
</h3>

                    </blockquote>
                </div>
                
            
            <br />
            </div>
        </div>

    </div>
</div>


        </div><footer>
    
    
    <div class="layui-container">
        <p class="copyright">&copy; All rights reserved. Powered by <a href='https://gohugo.io' style='color:#FFFFFF'>Hugo</a> and <a href='https://github.com/ertuil/erblog' style='color:#FFFFFF'>Erblog</a>.</p>
    </div>
</footer>

</body>
</html>
