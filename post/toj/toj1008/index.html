<html>
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Blame&#39;s Blog - TOJ 1008 速通麥塊 題解 </title>
    
    
    <meta content="TOJ, Matrix, Math, Dynamic Programming, Solution" name="keywords">
    
    <meta content="Blame&#39;s Blog - 題目連結 TOJ 1008 速通麥塊
前言 這題是我出在高一排名賽的防破台題
因為 brinton 那時候也是高一
結果卡到他的國培，所以他根本沒打到 哈哈
然後為啥會寫這篇文
因為我覺得我出的很好，所以推薦大家寫這題
阿好題就得配好題解
所以就來寫這篇了
看題目 我們可以簡單的看一下題目
我們可以發現
有 $N$ 堂課
每次翹課計畫必定相鄰的兩堂課不超過 $M$ 堂
然後翹第 $i$ 堂課可以拿到 $a_i$ 開心值
然後假如第 $k$ 次翹課 ($k \ge 2$)，那可以拿到 $\alpha_{\text{距離堂數}} \times \beta_{i}$
痾 上面還是基礎定義
所以我們應該可以知道簡單的 $DP$ 式為
$$ \displaystyle dp_i = \max(0, \max_{i-m \le j \le i-1} (dp_j) &#43; \alpha_{i-j} \times \beta_{i}) &#43; a_i $$
然後題目變難了一點點
第一種操作 是單點更改 $a_i$ 跟 $\beta_i$
第二種操作 是區間詢問，也就是給你 $l, r$" name="description">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    
        <link rel="icon" href="/img/logo.jpg">
    

    

    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            extensions: ["tex2jax.js"],
            jax: ["input/TeX", "output/HTML-CSS"],
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: true
            },
            "HTML-CSS": { availableFonts: ["TeX"] }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>
    

    <link rel="stylesheet" href="/layui/css/layui.css">
    <link rel="stylesheet" href="/self/css/default.css">
    <script src=" /layui/layui.js"></script>

    <link rel="stylesheet" async href="/self/css/markdown.min.css">
    <link rel="stylesheet" async href="/self/css/gallery.css">
    
    
    

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
    <script async src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js" integrity="sha256-PZEg+mIdptYTwWmLcBTsa99GIDZujyt7VHBZ9Lb2Jys=" crossorigin="anonymous"></script></head>

<script>
  MathJax = {
    tex: {
      inlineMath: {'[+]': [['$', '$']]}
    }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
<body>
    
    <header class="layui-header layui-bg-cyan">

    
        <a href=""><img src="/img/logo.jpg" class="layui-nav-img" style="margin-left:10px;margin-top:-10px"></a>
    
    
    <a class="nav-self-logo" href="/">
        Blame&#39;s Blog
    </a>

    <ul class="layui-nav layui-layout-right layui-bg-cyan" lay-filter="">
        
        
        <li class="layui-nav-item" id="nav_big"><a href="/post/">Posts</a></li>
        

        

        
        <li class="layui-nav-item" id="nav_small">
            <a href="javascript:;">
                <i class="layui-icon layui-icon-app" style="font-size: 24px;"></i>
            </a>

            <dl class="layui-nav-child">
                
                <dd><a href="/post/">Posts</a></dd>
                

                
            </dl>
        </li>
    </ul>
</header>

<script>
layui.use('element', function(){
  var element = layui.element;
});
</script>

        <div id="content" style="min-height:80%">
<div class="layui-container" style="margin-bottom: 10px">
    

    <div class="layui-row layui-col-space10">
        <div class="layui-col-md8 layui-col-sm12 layui-col-xs12">
            <div class="layui-card single-card">
                <br />
                <blockquote class="self-elem-quote  markdown-body single-title" >
                    <h1>TOJ 1008 速通麥塊 題解</h1>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-15</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/toj/">
            <span class="layui-badge " style="vertical-align: 2px;">TOJ</span>
        </a>
    
        <a href="/tags/matrix/">
            <span class="layui-badge " style="vertical-align: 2px;">Matrix</span>
        </a>
    
        <a href="/tags/math/">
            <span class="layui-badge " style="vertical-align: 2px;">Math</span>
        </a>
    
        <a href="/tags/dynamic-programming/">
            <span class="layui-badge " style="vertical-align: 2px;">Dynamic Programming</span>
        </a>
    
        <a href="/tags/solution/">
            <span class="layui-badge " style="vertical-align: 2px;">Solution</span>
        </a>
    
    
</h3>

                </blockquote>
                <div class="layui-card-body markdown-body single-content">
                    <h2 id="題目連結">題目連結</h2>
<p><a href="https://toj.tfcis.org/oj/pro/1008/">TOJ 1008 速通麥塊</a></p>
<h2 id="前言">前言</h2>
<p>這題是我出在高一排名賽的防破台題</p>
<p>因為 brinton 那時候也是高一</p>
<p>結果卡到他的國培，所以他根本沒打到 哈哈</p>
<p>然後為啥會寫這篇文</p>
<p>因為我覺得我出的很好，所以推薦大家寫這題</p>
<p>阿好題就得配好題解</p>
<p>所以就來寫這篇了</p>
<h2 id="看題目">看題目</h2>
<p>我們可以簡單的看一下題目</p>
<p>我們可以發現</p>
<p>有 $N$ 堂課</p>
<p>每次翹課計畫必定相鄰的兩堂課不超過 $M$ 堂</p>
<p>然後翹第 $i$ 堂課可以拿到 $a_i$ 開心值</p>
<p>然後假如第 $k$ 次翹課 ($k \ge 2$)，那可以拿到 $\alpha_{\text{距離堂數}} \times \beta_{i}$</p>
<p>痾 上面還是基礎定義</p>
<p>所以我們應該可以知道簡單的 $DP$ 式為</p>
<p>$$
\displaystyle
dp_i = \max(0, \max_{i-m \le j \le i-1} (dp_j) + \alpha_{i-j} \times \beta_{i}) + a_i
$$</p>
<p>然後題目變難了一點點</p>
<p>第一種操作 是單點更改 $a_i$ 跟 $\beta_i$</p>
<p>第二種操作 是區間詢問，也就是給你 $l, r$</p>
<p>你要找出一個合法子序列，且讓他的總和最大化</p>
<h2 id="一眼就能看出來的東西">一眼就能看出來的東西</h2>
<p>會發現我們只會用到 $\alpha_1 \cdots \alpha_M$ ㄏㄏ</p>
<h2 id="子題-1-是範測">子題 1 是範測</h2>
<p>ㄏㄏ</p>
<h2 id="子題-2">子題 2</h2>
<p>這個子題是給只要有認真看題目的人寫的</p>
<p>雖然這題沒人認真看</p>
<p>但出出來的目的其實就是訓練大家開題與讀題的技巧</p>
<p>並不一定要拿滿分才是最好的</p>
<p>隨便撈一撈分數有時候才反而可以打得更好!</p>
<p>好現在來講解法</p>
<p>也就是說我們按照題目去做</p>
<p>然後用我們剛剛一眼就看出來的 $DP$ 轉移式去求答案</p>
<p>單點修改就修改就行 ww</p>
<p>複雜度應該是 $O(NMQ)$</p>
<p>理論上應該要給 $Q \le 10$ 而已</p>
<p>但是想要騙一下很會分析複雜度的人</p>
<p>讓他們以為 $O(NMQ)$ 其實有反例之類的ww</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;vector&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> n, m; cin <span style="color:#f92672">&gt;&gt;</span> n <span style="color:#f92672">&gt;&gt;</span> m;
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> a(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), alpha(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), beta(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i<span style="color:#f92672">++</span>) cin <span style="color:#f92672">&gt;&gt;</span> a[i];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i<span style="color:#f92672">++</span>) cin <span style="color:#f92672">&gt;&gt;</span> alpha[i];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i<span style="color:#f92672">++</span>) cin <span style="color:#f92672">&gt;&gt;</span> beta[i];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> q; cin <span style="color:#f92672">&gt;&gt;</span> q;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span>(q<span style="color:#f92672">--</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> cmd; cin <span style="color:#f92672">&gt;&gt;</span> cmd;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(cmd <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i, A, B; cin <span style="color:#f92672">&gt;&gt;</span> i <span style="color:#f92672">&gt;&gt;</span> A <span style="color:#f92672">&gt;&gt;</span> B;
</span></span><span style="display:flex;"><span>            a[i] <span style="color:#f92672">=</span> A;
</span></span><span style="display:flex;"><span>            beta[i] <span style="color:#f92672">=</span> B;
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(cmd <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> l, r; cin <span style="color:#f92672">&gt;&gt;</span> l <span style="color:#f92672">&gt;&gt;</span> r;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>            vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> dp(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> l; i <span style="color:#f92672">&lt;=</span> r; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                dp[i] <span style="color:#f92672">=</span> a[i];
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> max(l, i<span style="color:#f92672">-</span>m); j <span style="color:#f92672">&lt;=</span> i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; j<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>                    dp[i] <span style="color:#f92672">=</span> max(dp[i], dp[j] <span style="color:#f92672">+</span> alpha[i<span style="color:#f92672">-</span>j]<span style="color:#f92672">*</span>beta[i] <span style="color:#f92672">+</span> a[i]);
</span></span><span style="display:flex;"><span>                ans <span style="color:#f92672">=</span> max(ans, dp[i]);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            cout <span style="color:#f92672">&lt;&lt;</span> ans <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#39;\n&#39;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="子題-3">子題 3</h2>
<p>我們會發現 $Q = 1$ 的話</p>
<p>代表只有詢問</p>
<p>所以我們就跟做子題 $2$ 一樣</p>
<p>只是把 int 改成 long long 就能過了</p>
<h2 id="子題-5">子題 5</h2>
<p>發現把子題 $2$ + 子題 $3$ 就能過子題 $5$ 了</p>
<p>因為 $2 + 3 = 5$ (x</p>
<h2 id="子題-4">子題 4</h2>
<p>我們發現區間詢問一個動態規劃的問題好難喔</p>
<p>動態規劃的問題不是只能靠著前面的狀態去做轉移嗎</p>
<p>那我每次區間詢問的動態規劃基底就不一樣了</p>
<p>那怎麼辦?</p>
<p>我們可以引入一個超級炫泡的技巧</p>
<p>叫做 <strong>動態動態規劃</strong></p>
<p>我們可以動態的做動態規劃</p>
<p>聽起來超酷的對吧?</p>
<h2 id="動態動態規劃-例題">動態動態規劃 例題</h2>
<p>首先先給你一個線性轉移的 $DP$ 式好了</p>
<p>$dp_i = dp_{i-1} \times 2 + dp_{i-2} \times 3$</p>
<p>有什麼酷酷的東西可以幫我們做到很快很快的轉移嗎?</p>
<p>對，沒錯</p>
<p>就是 <strong>矩陣乘法</strong></p>
<p>矩陣對於線性代數來講是一個非常基礎的東西</p>
<p>他能拿去對於狀態做 <strong>推移</strong></p>
<p>所以你只要用出一個推移矩陣(但我通常叫他轉移矩陣，因為他幫我轉移ㄏㄏ)</p>
<p>就可以把轉移式抽象為矩陣乘法</p>
<p>蛤? 你說這樣矩陣乘法還是線性的阿?</p>
<p>而且還多了矩陣乘法的 $O(N^3)$ 欸?</p>
<p>那你有沒有思考過經典的動態規劃優化技巧 &ndash; 矩陣快速冪?</p>
<p>為什麼這不能用在這題上面呢?</p>
<p>原因很簡單</p>
<p>因為你每一個轉移矩陣都不一樣，所以當你要乘上一堆矩陣的時候，你理論上應該要全部掃過所有東西!</p>
<p>蛤?這麼爛喔，那我們還用什麼矩陣!</p>
<h2 id="資結時刻">資結時刻!</h2>
<p>我們發現，矩陣乘法有結合律欸!</p>
<p>那我們腦中應該要有一個概念</p>
<p>當具有結合律的東西</p>
<p>我們還要符合</p>
<ol>
<li>單點修改</li>
<li>區間修改</li>
</ol>
<p>挖! <strong>線段樹</strong></p>
<p>我們可以發現，我們只要將矩陣丟上去線段樹上面</p>
<p>那就可以做到所有事情!!!!</p>
<h2 id="回本題">回本題</h2>
<p>蛤? 但是我們剛剛只知道怎麼做線性轉移的 DP 轉移阿</p>
<p>現在這題的轉移式有 $\max$ 欸</p>
<p>根本不能用矩陣乘法做了吧?</p>
<p>答案是，<strong>可以的</strong>。</p>
<p>當你上大學 <!-- raw HTML omitted -->聽說<!-- raw HTML omitted --> 可以用群論之類的東西去證明</p>
<p>$\max, \min$ 操作其實可以跟 $+, -$ 組成一個叫做 ($\max/\min$) ($plus/sub$) matrix 的東西</p>
<p>所以你只要把普通矩陣乘法中的 $\times$ 改成 $+$</p>
<p>把普通矩陣乘法中的 $+$ 改成 $\max$</p>
<p>那你就可以做出一個可以轉移本題轉移式的東西了!!!</p>
<h2 id="回歸子題-4">回歸子題 4</h2>
<p>這個子題只是給不會線段樹單點修改的人寫的</p>
<p>雖然有點引導往區間查詢的方向想</p>
<p>但相信能想到 max-plus matrix 的人應該可以瞬間刻完線段樹</p>
<p>所以拿分上應該是會跟滿分一起拿的子題，純純引導而已ww</p>
<h2 id="滿分解">滿分解</h2>
<p>痾下面為了方便，不失一般性的定義 $M = 5$</p>
<p>我們先定義一個基礎狀態的小小矩陣</p>
<p>可以想像我們現在狀態是一個長方形</p>
<p>他有著</p>
<p>$$
now =
\left[
\begin{matrix}
dp_{i-1} &amp; dp_{i-2} &amp; dp_{i-3} &amp; dp_{i-4} &amp; dp_{i-5}
\end{matrix}
\right]
$$</p>
<p>那麼我們只要乘上一個轉移矩陣 $T$</p>
<p>是否就可以拿到</p>
<p>$$
nxt =
\left[
\begin{matrix}
dp_{i} &amp; dp_{i-1} &amp; dp_{i-2} &amp; dp_{i-3} &amp; dp_{i-4}
\end{matrix}
\right]
$$</p>
<p>好好好，那我們來通靈一下轉移矩陣 $T$!</p>
<p>我們目標要使得 $now \times T = nxt$</p>
<p>$T$ 在右邊(因為矩陣乘法擺左右會不一樣，要小心)</p>
<p>痾 我們記得先想起來我們的矩陣乘法形式是 $max-plus$ matrix 喔</p>
<p>好首先我們可以知道
$\text{now&rsquo;s } dp_{i-1} \to \text{nxt&rsquo;s } dp_{i}$
$\text{now&rsquo;s } dp_{i-2} \to \text{nxt&rsquo;s } dp_{i-1}$
以此類推</p>
<p>所以可以先填格子上去!</p>
<p>$$
T =
\left[
\begin{matrix}
?? &amp; 0 &amp; -\infty &amp; -\infty &amp; -\infty\
?? &amp; -\infty &amp; 0 &amp; -\infty &amp; -\infty\
?? &amp; -\infty &amp; -\infty &amp; 0 &amp; -\infty\
?? &amp; -\infty &amp; -\infty &amp; -\infty &amp; 0\
?? &amp; -\infty &amp; -\infty &amp; -\infty &amp; -\infty
\end{matrix}
\right]
$$</p>
<p>那我們要怎麼填左邊那一列格子呢?</p>
<p>我們先定義 $now \to nxt$，$nxt$ 為第 $i$ 堂課，因為跟 $a_i, \beta_i$ 有關</p>
<p>那麼從 $\text{now&rsquo;s } dp_{i-1} \to \text{nxt&rsquo;s } dp_{i}$</p>
<p>是不是就是</p>
<p>$$
\text{nxt&rsquo;s } dp_{i} = \max(\text{nxt&rsquo;s } dp_{i}, \text{now&rsquo;s } dp_{i-1} + \alpha_{1} \times \beta_{i} + a_{i})
$$</p>
<p>以此類推，就可以把填格子遊戲玩完了</p>
<p>$$
T =
\left[
\begin{matrix}
\alpha_1 \times \beta_i + a_i &amp; 0 &amp; -\infty &amp; -\infty &amp; -\infty\
\alpha_2 \times \beta_i + a_i &amp; -\infty &amp; 0 &amp; -\infty &amp; -\infty\
\alpha_3 \times \beta_i + a_i &amp; -\infty &amp; -\infty &amp; 0 &amp; -\infty\
\alpha_4 \times \beta_i + a_i &amp; -\infty &amp; -\infty &amp; -\infty &amp; 0\
\alpha_5 \times \beta_i + a_i &amp; -\infty &amp; -\infty &amp; -\infty &amp; -\infty
\end{matrix}
\right]
$$</p>
<p>嗎?</p>
<p>發現不太對勁欸，我們好像少了某些東西!</p>
<p>我們能從任意起點開始</p>
<p>也就是說 $DP$ 式中的 $dp = max(a_i)$ 我們根本沒有算到!!!</p>
<p>但我們能在矩陣中做到這個東西嗎?</p>
<p>我們發現我們可以在矩陣中偷偷塞入一個神奇的 $0$!!!</p>
<p>$$
now =
\left[
\begin{matrix}
dp_{i-1} &amp; dp_{i-2} &amp; dp_{i-3} &amp; dp_{i-4} &amp; dp_{i-5} &amp; 0
\end{matrix}
\right]
$$</p>
<p>$$
nxt =
\left[
\begin{matrix}
dp_{i} &amp; dp_{i-1} &amp; dp_{i-2} &amp; dp_{i-3} &amp; dp_{i-4} &amp; 0
\end{matrix}
\right]
$$</p>
<p>轉移矩陣最後就變成了</p>
<p>$$
T =
\left[
\begin{matrix}
\alpha_1 \times \beta_i + a_i &amp; 0 &amp; -\infty &amp; -\infty &amp; -\infty &amp; -\infty\
\alpha_2 \times \beta_i + a_i &amp; -\infty &amp; 0 &amp; -\infty &amp; -\infty &amp; -\infty\
\alpha_3 \times \beta_i + a_i &amp; -\infty &amp; -\infty &amp; 0 &amp; -\infty &amp; -\infty\
\alpha_4 \times \beta_i + a_i &amp; -\infty &amp; -\infty &amp; -\infty &amp; 0 &amp; -\infty\
\alpha_5 \times \beta_i + a_i &amp; -\infty &amp; -\infty &amp; -\infty &amp; -\infty &amp; -\infty\
a_i &amp; -\infty &amp; -\infty &amp; -\infty &amp; -\infty &amp; 0
\end{matrix}
\right]
$$</p>
<p>挖 我們就真的把整個矩陣轉移推出來了</p>
<p>嗎?</p>
<p>我們發現我們還得紀錄每個結束點的最大值欸</p>
<p>怎麼這麼爛阿唉唉唉</p>
<p>不過聰明的你一定想到了!</p>
<p>我們再把答案丟進去矩陣中就行了阿!!!</p>
<p>$$
now =
\left[
\begin{matrix}
dp_{i-1} &amp; dp_{i-2} &amp; dp_{i-3} &amp; dp_{i-4} &amp; dp_{i-5} &amp; 0 &amp; ans_{i-1}
\end{matrix}
\right]
$$</p>
<p>$$
nxt =
\left[
\begin{matrix}
dp_{i} &amp; dp_{i-1} &amp; dp_{i-2} &amp; dp_{i-3} &amp; dp_{i-4} &amp; 0 &amp; ans_i
\end{matrix}
\right]
$$</p>
<p>$$
T =
\left[
\begin{matrix}
\alpha_1 \times \beta_i + a_i &amp; 0 &amp; -\infty &amp; -\infty &amp; -\infty &amp; -\infty &amp; \alpha_1 \times \beta_i + a_i\
\alpha_2 \times \beta_i + a_i &amp; -\infty &amp; 0 &amp; -\infty &amp; -\infty &amp; -\infty &amp; \alpha_2 \times \beta_i + a_i\
\alpha_3 \times \beta_i + a_i &amp; -\infty &amp; -\infty &amp; 0 &amp; -\infty &amp; -\infty &amp; \alpha_3 \times \beta_i + a_i\
\alpha_4 \times \beta_i + a_i &amp; -\infty &amp; -\infty &amp; -\infty &amp; 0 &amp; -\infty &amp; \alpha_4 \times \beta_i + a_i\
\alpha_5 \times \beta_i + a_i &amp; -\infty &amp; -\infty &amp; -\infty &amp; -\infty &amp; -\infty &amp; \alpha_5 \times \beta_i + a_i\
a_i &amp; -\infty &amp; -\infty &amp; -\infty &amp; -\infty &amp; 0 &amp; a_i\
-\infty &amp; -\infty &amp; -\infty &amp; -\infty &amp; -\infty &amp; -\infty &amp; 0
\end{matrix}
\right]
$$</p>
<p>我們就全部做完這題了!!!</p>
<h2 id="實作">實作</h2>
<p>因為實作能力非常重要</p>
<p>所以請自己努力練實作，這邊就不放 code 了</p>
<p>假如真的寫不出來的可以私訊我，或者偷偷開 admin 帳號跑去 TOJ 上面看我的 code 都行 :)</p>
<h2 id="結語">結語</h2>
<p>這是一題完全科技沒有思考的題目</p>
<p>畢竟我就是這種超級爛只會實作的選手</p>
<p>但是相信大家也可以從實作中摸索出解題的技巧</p>
<p>我覺得該題最有趣的應該是 matrix 的建構過程</p>
<p>我已經盡量將我當初思考的步驟還原出來了</p>
<p><!-- raw HTML omitted --><strong>hope u guys enjoy it !</strong><!-- raw HTML omitted --></p>
<h2 id="臭一下">臭一下</h2>
<p>現場打比賽的人真的要檢討一下</p>
<p>只要會讀題目 + 寫正常的 dp 式就能拿到 $54$ 分</p>
<p>不要被題目嚇到了，有時候子題超好拿，你還不拿，根本自己嗆自己</p>
</div>
            </div>
        </div>

        <div class="layui-col-md4 layui-col-sm12 layui-col-xs12">
            

            <div class="layui-card single-card">
                <h2 class="single-title">Recent Posts</h2>
            
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote " style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/atcoder/abc345f/">
                        <h3 class="">ABC345 F - Many Lamps</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-17</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/atcoder/">
            <span class="layui-badge " style="vertical-align: 2px;">Atcoder</span>
        </a>
    
        <a href="/tags/solution/">
            <span class="layui-badge " style="vertical-align: 2px;">Solution</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote " style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/toj/toj1008/">
                        <h3 class="">TOJ 1008 速通麥塊 題解</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-15</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/toj/">
            <span class="layui-badge " style="vertical-align: 2px;">TOJ</span>
        </a>
    
        <a href="/tags/matrix/">
            <span class="layui-badge " style="vertical-align: 2px;">Matrix</span>
        </a>
    
        <a href="/tags/math/">
            <span class="layui-badge " style="vertical-align: 2px;">Math</span>
        </a>
    
        <a href="/tags/dynamic-programming/">
            <span class="layui-badge " style="vertical-align: 2px;">Dynamic Programming</span>
        </a>
    
        <a href="/tags/solution/">
            <span class="layui-badge " style="vertical-align: 2px;">Solution</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote " style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/contest/nccu/">
                        <h3 class="">2025全國賽心得</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-14</span>

    
    

    

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 1px;margin-right:2px;"></i>
    

    
        <a href="/tags/experience/">
            <span class="layui-badge " style="vertical-align: 2px;">Experience</span>
        </a>
    
    
</h3>

                    </blockquote>
                </div>
                
                <div style="margin-left: 10px;">
                    <blockquote class="self-elem-quote " style="background-color:#FFFFFF;margin-top: 10px;">
                    <a href="/post/hello/intro/">
                        <h3 class="">自我介紹</h3>
                    </a>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 28px; vertical-align: -2px;"></i>
    <span>2025-12-08</span>

    
    

    

    

    
    
</h3>

                    </blockquote>
                </div>
                
            
            <br />
            </div>
        </div>

    </div>
</div>


        </div><footer>
    
    
    <div class="layui-container">
        <p class="copyright">&copy; All rights reserved. Powered by <a href='https://gohugo.io' style='color:#FFFFFF'>Hugo</a> and <a href='https://github.com/ertuil/erblog' style='color:#FFFFFF'>Erblog</a>.</p>
    </div>
</footer>

</body>
</html>
